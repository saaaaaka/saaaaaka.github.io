name: Auto Add and Commit and Push

on:
  push:
    branches: [ main ]  # mainブランチにプッシュされた際にトリガーされます

jobs:
  auto_commit_push:
    runs-on: ubuntu-latest  # Ubuntu環境で実行

    steps:
      - name: Checkout code
        uses: actions/checkout@v3  # リポジトリのコードをチェックアウト

      - name: Set up Git
        run: |
          git config user.name "saaaaaka"  # Gitユーザー名を設定
          git config user.email "kka449783@gmail.com"  # Gitメールアドレスを設定

      - name: Verify the current state
        run: |
          git status  # 現在の状態を確認

      - name: Copy the new rendered image
        run: |
          # Blenderでレンダリングされた画像ファイルをリポジトリの images フォルダにコピー
          mv "C:\Users\skzz5\OneDrive\デスクトップ\sotsuron\3d1\saaaaaka.github.io\images"
          git status  # 変更が反映されたか確認

      - name: Commit changes
        run: |
          git commit -m "Automated commit: Added new render_image.png" || echo "No changes to commit"

      - name: Push changes to repository
        run: |
           git config user.name "saaaaaka[bot]"
           git config user.email "kka449783[bot]@gmail.com"
           git remote set-url origin https://github.com/saaaaaka/saaaaaka.github.io
           git push origin main
        env:
            TOKEN: ${{ secrets.ACTIONS_PAT }}  # GitHubのアクセストークンを使用
